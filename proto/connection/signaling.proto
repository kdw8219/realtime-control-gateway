syntax = "proto3";

package robot.signaling;

// WebRTC Signaling between Robot and Server
service RobotSignalService {
  rpc OpenSignalStream(stream SignalMessage) returns (stream SignalMessage);
}

// Single message exchanged over the stream
message SignalMessage {
  string robot_id = 1;

  oneof payload {
    ScreenRequest screen_request = 2;

    RobotOffer robot_offer = 3;
    IceCandidate robot_ice = 4;

    ClientAnswer client_answer = 5;
    IceCandidate client_ice = 6;

    WebrtcError webrtc_error = 7;
  }
}

message ScreenRequest {
}

message RobotOffer {
  string sdp = 1;
  string type = 2; // "offer"
}

message ClientAnswer {
  string sdp = 1;
  string type = 2; // "answer"
}

message IceCandidate {
  string candidate = 1;
  string sdp_mid = 2;
  int32 sdp_mline_index = 3;
}

message WebrtcError {
  string error = 1;
}
